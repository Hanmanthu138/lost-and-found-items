<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lost & Found</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; }
    label, input, textarea, select { display: block; width: 100%; margin-bottom: 10px; }
    button { padding: 10px; background: #28a745; color: white; border: none; cursor: pointer; }
    #results { margin-top: 20px; }
    img { max-width: 100%; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Lost Item Finder</h1>
    <form id="lostForm">
      <label for="name">Your Name:</label>
      <input type="text" id="name" required>
      <label for="item">Lost Item Name:</label>
      <input type="text" id="item" required>
      <label for="category">Item Category:</label>
      <select id="category" required>
        <option value="electronics">Electronics</option>
        <option value="clothing">Clothing</option>
        <option value="documents">Documents</option>
        <option value="accessories">Accessories</option>
        <option value="others">Others</option>
      </select>
      <label for="description">Description:</label>
      <textarea id="description" required></textarea>
      <label for="location">Last Seen Location:</label>
      <input type="text" id="location" required>
      <label for="photo">Upload Photo:</label>
      <input type="file" id="photo" accept="image/*" required>
      <button type="submit">Report Lost Item</button>
    </form>

    <div id="results">
      <h3>Possible Matches</h3>
      <ul id="matches"></ul>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DATABASE_URL",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const storage = firebase.storage();

    const form = document.getElementById('lostForm');
    const matchesList = document.getElementById('matches');

    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const name = document.getElementById('name').value;
      const item = document.getElementById('item').value;
      const category = document.getElementById('category').value;
      const description = document.getElementById('description').value;
      const location = document.getElementById('location').value;
      const photoFile = document.getElementById('photo').files[0];

      const uniqueCode = 'LST' + Date.now();

      const storageRef = storage.ref(`lostItems/${uniqueCode}_${photoFile.name}`);
      storageRef.put(photoFile).then(snapshot => {
        snapshot.ref.getDownloadURL().then(photoURL => {
          const lostItem = {
            name,
            item,
            category,
            description,
            location,
            photoURL,
            timestamp: Date.now(),
            code: uniqueCode
          };

          database.ref(`lostItems/${category}`).push(lostItem);
          database.ref(`lostItemsAll/${uniqueCode}`).set(lostItem);

          alert(`Lost item reported successfully!\nYour Retrieval Code is: ${uniqueCode}`);
          form.reset();

          database.ref(`foundItems/${category}`).once('value', snapshot => {
            matchesList.innerHTML = '';
            const data = snapshot.val();
            if (data) {
              Object.values(data).forEach(found => {
                if (
                  found.item.toLowerCase() === item.toLowerCase() &&
                  found.location.toLowerCase().includes(location.toLowerCase())
                ) {
                  const li = document.createElement('li');
                  li.innerHTML = `<strong>${found.item}</strong> - ${found.description} at ${found.location}<br><img src="${found.photoURL}" alt="Found Item Image">`;
                  matchesList.appendChild(li);
                }
              });
            }
          });
        });
      });
    });
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Retrieve Lost Item</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #eef2f5; margin: 0; padding: 20px; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; box-shadow: 0 0 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    input, button { width: 100%; padding: 10px; margin-top: 10px; }
    img { max-width: 100%; margin-top: 10px; }
    .item-info { margin-top: 20px; }
  </style>
</head>
<body>

  <div class="container">
    <h2>Retrieve Your Lost Item</h2>
    <input type="text" id="retrievalCode" placeholder="Enter Your Unique Code" required>
    <button onclick="fetchItem()">Get Item Info</button>
    <div class="item-info" id="itemInfo"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DATABASE_URL",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function fetchItem() {
      const code = document.getElementById('retrievalCode').value.trim();
      const itemInfo = document.getElementById('itemInfo');

      if (!code) {
        alert("Please enter your unique code.");
        return;
      }

      database.ref("lostItemsAll/" + code).once("value").then(snapshot => {
        const data = snapshot.val();
        if (data) {
          itemInfo.innerHTML = `
            <h3>Item: ${data.item}</h3>
            <p><strong>Owner:</strong> ${data.name}</p>
            <p><strong>Category:</strong> ${data.category}</p>
            <p><strong>Description:</strong> ${data.description}</p>
            <p><strong>Last Seen Location:</strong> ${data.location}</p>
            <img src="${data.photoURL}" alt="Lost Item">
          `;
        } else {
          itemInfo.innerHTML = "<p>No item found with that code.</p>";
        }
      }).catch(err => {
        console.error(err);
        itemInfo.innerHTML = "<p>Error retrieving item. Please try again later.</p>";
      });
    }
  </script>
</body>
</html>
